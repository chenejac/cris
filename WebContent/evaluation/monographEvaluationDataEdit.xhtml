<ui:composition xmlns="http://www.w3.org/1999/xhtml"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:p="http://primefaces.org/ui"
     xmlns:mytags="http://dragan.tmd.uns.ac.rs/mytags">    
     
     
     <h:panelGrid id="monographEvaluationDataEditPanelGrid" >
     	<p:inputText id="general" rendered="false" value="" />
		<p:outputPanel ajaxRendered="true">
			<p:message
				for="general"
				errorClass="errorMessage"
				infoClass="infoMessage"
				warnClass="warnMessage"
				fatalClass="fatalMessage"/>
		</p:outputPanel>
		<p:outputPanel ajaxRendered="true" style="border: 2px !important, margin: 20 px ">
					<h:outputText 
						value="#{monographManagedBean.selectedMonograph.HTMLRepresentation}"						
						escape="false"/>		
	    </p:outputPanel>
		<p:tabView>
			<p:tab
				name="tab0" 
				rendered="#{(monographManagedBean.editTabNumber == 0) or (monographManagedBean.editMode == modesManagedBean.viewDetails)}"
				header="#{messages['evaluation.evaluationData.evaluationData']}">
				
				<h:panelGrid columns="2" columnClasses="width40, width60">
					<p:outputPanel ajaxRendered="true">
							<mytags:outputLabel 
								value="#{messages['evaluation.evaluationData.numberOfPages']} *" 
								for="numberOfPages"  
								errorStyleClass="errorMessage"
								/>								
						</p:outputPanel>
						<p:inputText
							id="numberOfPages"
							readonly="#{! empty monographManagedBean.selectedMonograph.numberOfPages}" 
							value="#{monographManagedBean.selectedMonograph.numberOfPages}" />
						<p:outputPanel ajaxRendered="true">
							<mytags:outputLabel 
								value="#{messages['evaluation.evaluationData.hÐ°sReviewInInternationJournal']} *" 
								for="hasReviewInInternationJornal"  
								errorStyleClass="errorMessage"
								/>								
						</p:outputPanel>
						<p:inputText
							id="hasReviewInInternationJornal"							 
							value="#{monographManagedBean.selectedMonograph.evaluationData.hasReviewInInternationalJournal}" />	
						<p:outputPanel ajaxRendered="true">
							<mytags:outputLabel 
								value="#{messages['evaluation.evaluationData.numberOfReviewers']} *" 
								for="numberOfReviewer"  
								errorStyleClass="errorMessage"
								/>								
						</p:outputPanel>
						<p:inputText
							id="numberOfReviewer"							 
							value="#{monographManagedBean.selectedMonograph.evaluationData.numberOfReviewers}" />							
				</h:panelGrid>
				
				<h:panelGrid columns="1">
					<h:outputText 
							value="#{messages['evaluation.evaluationData.autocitations']} *"						
							escape="false"/>
					<p:dataTable
						value="#{monographManagedBean.selectedMonographEvaluationData.autocitations}"
						var = "autocitation">
						<p:column>
			            	<f:facet name="header">
			                	<h:outputText value="#{messages['evaluation.evaluationData.lastnameAndFirstname']}" />
			            	</f:facet>
			            	<h:outputText value="#{autocitation.forResearcher.name.lastname} #{autocitation.forResearcher.name.firstname}" />		            
			        	</p:column>
						<p:column>
							<f:facet name="header">
			                	<h:outputText value="#{messages['evaluation.evaluationData.autocitationsM20']}" />
			            	</f:facet>
			            	<p:inputText value="#{autocitation.numberOfAutocitationM20}" />
						</p:column>
						<p:column>
							<f:facet name="header">
			                	<h:outputText value="#{messages['evaluation.evaluationData.autocitationsM50']}" />
			            	</f:facet>
			            	<p:inputText value="#{autocitation.numberOfAutocitationM50}" />
						</p:column>
					</p:dataTable>
				</h:panelGrid>				
			</p:tab>
			<p:tab
				name="tab1" 
				rendered="#{(monographManagedBean.editTabNumber == 1) or (monographManagedBean.editMode == modesManagedBean.viewDetails)}"
				header="Dokumenata">
				<h:panelGrid id="uploadFilePanelGrid">
				<p:dataTable
					value="#{monographManagedBean.selectedMonographEvaluationData.attachedFiles}"
					var="file"
					id="uploadedFilesDataTable"
					styleClass="stable" tableStyle="width:auto"	>
					<p:column>
						<f:facet name="header">
							<h:outputText value="#{messages['evaluation.evaluationData.nameOfFile']}" />
						</f:facet>
						<h:outputText value="#{file.fileNameClient}" />
					</p:column>
					<p:column>
						<f:facet name="header">
							<h:outputText value="#{messages['evaluation.evaluationData.link']}" />
						</f:facet>
						<h:outputLink value="#{monographManagedBean.getFileURL(file)}" target="_blank">
							<h:outputText value="#{messages['evaluation.evaluationData.openFile']}" />
						</h:outputLink>						
					</p:column>
					<p:column>
						<f:facet name="header">
							<h:outputText value="#{messages['evaluation.evaluationData.deletion']}" />
						</f:facet>
						<p:commandLink
							action="#{monographManagedBean.deleteAttachedFile(file)}"				
							execute="@this"
							render="uploadFilePanelGrid"
							>
							<h:graphicImage library="img" name="delete.png" />
						</p:commandLink>
					</p:column>
				</p:dataTable>
				<p:fileUpload
						id="fileUpload"
						rendered="true"
						fileUploadListener="#{monographManagedBean.uploadListener}"				        
				        listHeight="50"
				        listWidth="300"
				        acceptedTypes="pdf, doc, docx, odt"
				        addLabel="#{messages['evaluation.evaluationData.add']}"		
				        clearAllLabel="#{messages['evaluation.evaluationData.clearAll']}"		
				        deleteLabel="#{messages['evaluation.evaluationData.delete']}"    
				        uploadLabel="#{messages['evaluation.evaluationData.upload']}"   
				        doneLabel="#{messages['evaluation.evaluationData.done']}"
				        sizeExceededLabel="#{messages['evaluation.evaluationData.sizeExceeded']}"				        
				        allowFlash="auto">
				      <p:ajax event="uploadcomplete" render="monographEvaluationDataModalPanel" execute="@form" />
				  </p:fileUpload>
				</h:panelGrid>			
			</p:tab>
		</p:tabView>
		<p:commandButton
					action="#{monographManagedBean.nextEditTab()}"
					value="#{messages['records.monograph.editPanel.btnNext']}"
					rendered="#{(monographManagedBean.editTabNumber == 0) or (monographManagedBean.editMode == modesManagedBean.viewDetails)}"
					update="monographEvaluationDataModalPanel"
					limitRender="true" 
					execute="@form" />					
		<p:commandButton
					action="#{monographManagedBean.saveEvaluationData()}"
					value="#{messages['records.monograph.editPanel.btnUpdate']}"
					rendered="#{(monographManagedBean.editTabNumber == 1) or (monographManagedBean.editMode == modesManagedBean.viewDetails)}"
					update="monographEvaluationDataModalPanel"
					limitRender="true" 
					execute="@form" />     	
     </h:panelGrid>     
</ui:composition>     