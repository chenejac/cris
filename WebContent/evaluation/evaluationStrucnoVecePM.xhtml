<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:p="http://primefaces.org/ui"
     xmlns:mytags="http://dragan.tmd.uns.ac.rs/mytags"
     >
	<f:view locale="#{userManagedBean.language}" 
		contentType="text/html; charset=iso-8859-1" 
		beforePhase="#{evaluationStrucnoVecePMManagedBean.enterPage}" >
		<h:head>
			<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
			<meta http-equiv="Refresh" content="#{session.maxInactiveInterval};url=index.html" />
			<meta http-equiv="Pragma" content="no-cache"/>
			<meta http-equiv="Expires" content="-1"/>
			<title><ui:insert name="title">CRIS UNS</ui:insert></title>
		</h:head>
		<h:body>
			<h:outputStylesheet library="stylesheet" name="theme.css" target="head"/>
			<h:outputScript library="js" name="functions.js" target="head"/>
			<f:loadBundle
				basename="rs.ac.uns.ftn.informatika.bibliography.utils.ResourceBoundles"
				var="messages" />
			<div id="center">
				<p:spacer
					height="20"
					width="1" 
					/>
				<div id="pleaseWait" class="transparent"></div>
				<div id="progressBar" class="progressbar"><h:graphicImage
					library="img" name="progressbar.gif"></h:graphicImage></div>
				<p:ajaxStatus for="form_region" onstart="onStart()" onstop="onStop()"/>
				<p:fragment id="form_region">
					<h:form id="evaluationStrucnoVecePMTableForm">
						<h:panelGrid id="mainPanel">
							<p:inputText id="general" rendered="false" value="" />
							<p:outputPanel ajaxRendered="true">
								<p:message
									for="general"
									errorClass="errorMessage"
									infoClass="infoMessage"
									warnClass="warnMessage"
									fatalClass="fatalMessage"/>
							</p:outputPanel>
							
							<p:panel id="evaluationStrucnoVecePMPanel">
								<f:facet name="header">		
									<h:outputText value="#{messages['evaluation.mainPanel.journalPanel.header']}" />
								</f:facet>
								<h:panelGrid id="journalSelection" columns="2" rendered="true" columnClasses="width15, width85" width="100%">
									<p:outputPanel ajaxRendered="true">
										<mytags:outputLabel 
											value="#{messages['evaluation.mainPanel.journalSelection.journalName']}: " 
											for="name" 
											errorStyleClass="errorMessage"
											/>
									</p:outputPanel>
									<p:autoComplete mode="cachedAjax" minChars="3" selectFirst="false"
	            						id="name" 
										value="#{evaluationStrucnoVecePMManagedBean.journalSomeName}" 
										autocompleteMethod="#{journalManagedBean.autocompleteName}"
										var="_journalRow"
			            				fetchValue="#{_journalRow.controlNumber}"
			            				autofill="false"
			            				onselectitem="jsFuncChoose()" 
			            				style="width:100% !important;"
										inputClass="width98" 
			            				>
			            			 	<!--     ........  name   ISSN .......-->
							            <p:column
											style="'background-color:#{org.richfaces.SKIN.tableBackgroundColor}';"
											styleClass="rich-table-wide-cell">
											<h:outputText value="#{_journalRow.someName} &nbsp; ( &nbsp; #{_journalRow.issn} &nbsp;)"/>	
										</p:column>
									</p:autoComplete>
	            					
									<p:outputPanel ajaxRendered="true">
										<mytags:outputLabel 
											value="#{messages['evaluation.mainPanel.journalSelection.journalISSN']}: " 
											for="ISSN" 
											errorStyleClass="errorMessage"
											/>
									</p:outputPanel>
									<p:autoComplete mode="cachedAjax" minChars="3" selectFirst="false"
	            						id="ISSN" 
										value="#{evaluationStrucnoVecePMManagedBean.journalISSN}" 
										autocompleteMethod="#{journalManagedBean.autocompleteISSN}"
										var="_journalRow"
			            				fetchValue="#{_journalRow.controlNumber}"
			            				autofill="false"
			            				onselectitem="jsFuncChoose()"
			            				style="width:60% !important;"
										inputClass="width98"
			            				>
			            			 	<!--     ........  ISSN   .......-->
							            <p:column
											style="'background-color:#{org.richfaces.SKIN.tableBackgroundColor}';"
											styleClass="rich-table-wide-cell">
											<h:outputText value="#{_journalRow.issn} &nbsp; ( &nbsp; #{_journalRow.someName} &nbsp;)"/>		
										</p:column>
									</p:autoComplete>
													
									
									<p:remoteCommand
											name="jsFuncChoose"
											execute="name ISSN"
											action="#{evaluationStrucnoVecePMManagedBean.setAllFromJournal}" 
											render="mainPanel"
											
											>
									</p:remoteCommand>
									
								</h:panelGrid>
						 	</p:panel>
						 	
						 	<p:panel id="evaluationYearCommissionPanel">
						 		<f:facet name="header">
										<h:outputText value="#{messages['evaluation.mainPanel.yearCommissionPanel.header']}" />
								</f:facet>
								
						 		<h:panelGrid id="yearCommissionSelection" columns="4" rendered="true" columnClasses="width10, width70, width10, width10" width="100%">
						 			
						 				<mytags:outputLabel 
											value="#{messages['evaluation.mainPanel.yearCommissionSelection.year']}: " 
											for="year" 
											errorStyleClass="errorMessage"
											/>
										<p:inputText id="year" value="#{evaluationStrucnoVecePMManagedBean.year}">
											<f:validateLongRange minimum="#{evaluationStrucnoVecePMManagedBean.minEvaluationYear}" maximum="#{evaluationStrucnoVecePMManagedBean.maxEvaluationYear}"/>
											<p:clientValidator />
										</p:inputText>
										<p:outputPanel ajaxRendered="true">
											<p:message
												for="year" 
												errorClass="errorMessage"
												infoClass="infoMessage"
												warnClass="warnMessage"
												fatalClass="fatalMessage" />
										</p:outputPanel>
						 			
						 				<h:outputText value="" />
						 			
						 			
						 				<mytags:outputLabel 
											value="#{messages['evaluation.mainPanel.yearCommissionSelection.commission']}: " 
											for="commission" 
											errorStyleClass="errorMessage"
											/>
										
										<p:selectOneMenu id="commission" value="#{evaluationStrucnoVecePMManagedBean.commissionID}" onchange="jsSetRulebook()">
											<f:selectItems value="#{evaluationStrucnoVecePMManagedBean.allCommissions}"/>
										</p:selectOneMenu>

						 				<mytags:outputLabel 
											value=" #{messages['evaluation.mainPanel.yearCommissionSelection.fullText']}: " 
											for="rulebookPng" 
											errorStyleClass="errorMessage"
											/>
											
										<h:outputLink 
											value="#{evaluationStrucnoVecePMManagedBean.pdfUrl}"
											target="_blank" 
											rendered="#{not empty evaluationStrucnoVecePMManagedBean.commissionID}">
											<h:graphicImage library="img" name="download32.png" id="rulebookPng" alt="none"/>
										</h:outputLink>	
										<h:graphicImage library="img" name="download32.png" id="rulebookPng1" alt="none" rendered="#{empty evaluationStrucnoVecePMManagedBean.commissionID}"/>

										<h:outputText value="" />
										<h:outputText value="" />
										<h:outputText value="" />
										
							 			<p:commandButton
							 				value="#{messages['evaluation.mainPanel.yearCommissionSelection.btnEvaluate']}"
							 				action="#{evaluationStrucnoVecePMManagedBean.evaluateSelectedJournalForCommissionAndYear()}"
							 				render="evaluationEvaluationResultsPanel"
							 				execute="year commission" >
								        </p:commandButton>
							        
							        	<p:remoteCommand
												name="jsSetRulebook"
												execute="year commission"
												render="mainPanel"
												action="#{evaluationStrucnoVecePMManagedBean.setCommissionRuleBook}" 
												>
										</p:remoteCommand>
							        			 			
						 		</h:panelGrid>
						 	
						 	</p:panel>
						 	
						 	<p:panel id="evaluationEvaluationResultsPanel" rendered="true">
						 		<f:facet name="header">
										<h:outputText value="#{messages['evaluation.mainPanel.evaluationResultsPanel.header']}" />
								</f:facet>
								
								<h:panelGrid id="evaluationResults" columns="1" rendered="true" columnClasses="width100" width="100%">
									
						 				
											<p:dataTable columnClasses="width80, width10, width10" var="listVar" value="#{evaluationStrucnoVecePMManagedBean.evaluatedResylts}"
											rendered="#{not empty evaluationStrucnoVecePMManagedBean.evaluatedResylts}" width="100% !important">
											
												<f:facet name="header">
													<p:columnGroup>
				   										<p:column colspan="1" rowspan="1" style="text-align:center">
				   										<h:outputText escape="false">	 <h:outputFormat value="#{messages['evaluation.mainPanel.evaluationResultsPanel.results.header.name']}"> <f:param value="#{evaluationStrucnoVecePMManagedBean.journalSomeName}"/> <f:param value="#{evaluationStrucnoVecePMManagedBean.year} "/> </h:outputFormat> </h:outputText>
							                            </p:column>
							                            <p:column colspan="1" rowspan="1">
							                            	<h:outputText value="#{messages['evaluation.mainPanel.evaluationResultsPanel.results.header.code']}"/>
							                            </p:column>
							                            <p:column colspan="1" rowspan="1">
							                            	<h:outputText value="#{messages['evaluation.mainPanel.evaluationResultsPanel.results.header.score']}"/> 
							                            </p:column>
						                        	</p:columnGroup>
												</f:facet>
												
												<p:column>
					    								<h:outputText value="#{listVar[0]}" escape="false"/>		
												</p:column>
												<p:column>
					    								<h:outputText value="#{listVar[1]}" escape="false"/>		
												</p:column>
												<p:column>
					    								<h:outputText value="#{listVar[2]}" escape="false"/>		
												</p:column>
											</p:dataTable>
											
											<rich:collapsiblePanel header="#{messages['evaluation.mainPanel.evaluationResultsDetailExplanationPanel.header']}" switchType="ajax" rendered="#{not empty evaluationStrucnoVecePMManagedBean.evaluatedResylts}" expanded="false">
									            <h:panelGrid columns="1" rendered="true" width="100%" id="detailExplanation">
									            	
									            	<h:outputText value="#{evaluationStrucnoVecePMManagedBean.detailExplanation}"/>
									            	
													<br/>
							
									            	<p:dataTable var="listVarTabel1"
									            	value="#{evaluationStrucnoVecePMManagedBean.evaluatedResyltsImpactFactorsWithCategories}" 
									            	rendered="#{evaluationStrucnoVecePMManagedBean.renderTabelaTip1}"
									            	rowKeyVar="kWar1">																
														<p:column style="#{(kWar1 ge 3) ? 'background-color: #DCF0F7 !important;' : 'background-color: #CCCCCC !important;'}">
							    								<h:outputText value="#{listVarTabel1[0]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel1[1]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel1[2]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel1[3]}" escape="false"/>		
														</p:column>
													</p:dataTable>

										            <p:dataTable var="listVarTabel3"
										            	value="#{evaluationStrucnoVecePMManagedBean.evaluatedResyltsImpactFactorsWithCategories}" 
										            	rendered="#{evaluationStrucnoVecePMManagedBean.renderTabelaTip3}"
										            	rowKeyVar="kWar3">														
															<p:column style="#{(kWar3 ge 3) ? 'background-color: #DCF0F7 !important;' : 'background-color: #CCCCCC !important;'}">
								    								<h:outputText value="#{listVarTabel3[0]}" escape="false"/>		
															</p:column>
															<p:column style="text-align:center">
								    								<h:outputText value="#{listVarTabel3[1]}" escape="false"/>		
															</p:column>
															<p:column style="text-align:center">
								    								<h:outputText value="#{listVarTabel3[2]}" escape="false"/>		
															</p:column>
															<p:column style="text-align:center">
								    								<h:outputText value="#{listVarTabel3[3]}" escape="false"/>		
															</p:column>
															<p:column style="text-align:center">
								    								<h:outputText value="#{listVarTabel3[4]}" escape="false"/>		
															</p:column>
													</p:dataTable>
													
									            	<rich:extendedDataTable 
									            	
									            	id = "extendedDataTable2"
										            rows="17"
										            frozenColumns="1"
										            rowKeyVar="kWar2"
										            var="listVarTabel2" 
								            		value="#{evaluationStrucnoVecePMManagedBean.evaluatedResyltsImpactFactorsWithCategories}" 
								            		rendered="#{evaluationStrucnoVecePMManagedBean.renderTabelaTip2}"
								            		selectionMode="none"
								            		style="max-width: 1200px;">
								            	
									            		<p:column style="#{(kWar2 ge 3) ? 'background-color: #DCF0F7 !important;' : 'background-color: #CCCCCC !important;'}">
							    								<h:outputText value="#{listVarTabel2[0]}" escape="false"/>	
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[1]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[2]}" escape="false"/>		
														</p:column>
									            		<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[3]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[4]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[5]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[6]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[7]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[8]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[9]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[10]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[11]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[12]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[13]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[14]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[15]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel2[15]}" escape="false"/>		
														</p:column>
									            	</rich:extendedDataTable>
													
													<rich:extendedDataTable
													id = "extendedDataTable4" 
										            rows="33"
										            frozenColumns="1"
										            rowKeyVar="kWar4"
										            var="listVarTabel4" 
								            		value="#{evaluationStrucnoVecePMManagedBean.evaluatedResyltsAllYears}" 
								            		rendered="#{not empty evaluationStrucnoVecePMManagedBean.evaluatedResyltsAllYears}"
								            		selectionMode="none"
								            		style="max-width: 1200px;">
								            	
									            		<p:column style="#{(kWar4 ge 3) ? 'background-color: #DCF0F7 !important;' : 'background-color: #CCCCCC !important;'}">
							    								<h:outputText value="#{listVarTabel4[0]}" escape="false"/>	
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[1]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[2]}" escape="false"/>		
														</p:column>
									            		<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[3]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[4]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[5]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[6]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[7]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[8]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[9]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[10]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[11]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[12]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[13]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[14]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[15]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[16]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[17]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[18]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[19]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[20]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[21]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[22]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[23]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[24]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[25]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[26]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[27]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[28]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[29]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[30]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[31]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[32]}" escape="false"/>		
														</p:column>
														<p:column style="text-align:center">
							    								<h:outputText value="#{listVarTabel4[32]}" escape="false"/>		
														</p:column>
									            	</rich:extendedDataTable>
									            	
													<br/>
													
									            	
									            	<p:dataTable var="listVarTabel2Hed"
									            		columnClasses="width20, width80"
										            	value="#{evaluationStrucnoVecePMManagedBean.evaluatedResyltsLegendCategories}" 
										            	rendered="#{(not empty evaluationStrucnoVecePMManagedBean.evaluatedResyltsImpactFactorsWithCategories)}">																
															<f:facet name="header">
													            <p:columnGroup>
													            	<p:column>
													                    <h:outputText value="#{messages['evaluation.mainPanel.evaluationResultsPanel.detailExplanation.tableColumnHeaderAbbreviations']}" />
													                </p:column>
													                <p:column>
													                    <h:outputText value="#{messages['evaluation.mainPanel.evaluationResultsPanel.detailExplanation.tableColumnHeaderScienceField']}" />
													                </p:column>
													            </p:columnGroup>
													        </f:facet>
													        <p:column style="text-align:center; background-color: #DCF0F7 !important;">
								    							<h:outputText value="#{listVarTabel2Hed[0]}" escape="false"/>		
															</p:column>
															<p:column>
								    							<h:outputText value="#{listVarTabel2Hed[1]}" escape="false"/>
															</p:column>
													</p:dataTable>
													<p:commandButton
										 				value="#{messages['evaluation.mainPanel.evaluationResultsPanel.detailExplanation.tableShowAllButton']}"
										 				action="#{evaluationStrucnoVecePMManagedBean.calculateExplainTableAllYears()}"
										 				render="detailExplanation"
										 				rendered="#{empty evaluationStrucnoVecePMManagedBean.evaluatedResyltsAllYears}" >
											        </p:commandButton>
													
													<br/>    
												</h:panelGrid>
									        </rich:collapsiblePanel>
								</h:panelGrid>
						 	</p:panel>
						</h:panelGrid>
					</h:form>
				</p:fragment>
			</div>
			<p:spacer
				height="70"
				width="1"/>
			<div id="footer">
    			<ui:insert name="footer">
					<ui:include src="../footer.xhtml"/>
				</ui:insert>
			</div>
		</h:body>
	</f:view>
</html>
