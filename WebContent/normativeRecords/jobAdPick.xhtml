<ui:composition xmlns="http://www.w3.org/1999/xhtml"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:p="http://primefaces.org/ui"
     xmlns:mytags="http://dragan.tmd.uns.ac.rs/mytags">
     
	<h:panelGrid id="jobAdPickFormPanel">
		<p:inputText id="general" rendered="false" value="" />
		<p:outputPanel ajaxRendered="true">
			<p:message
				for="general"
				errorClass="errorMessage"
				infoClass="infoMessage"
				warnClass="warnMessage"
				fatalClass="fatalMessage"/>
		</p:outputPanel>
		<p:outputPanel ajaxRendered="true"
				rendered="#{(jobAdManagedBean.customPick) and (jobAdManagedBean.tableTabNumber == 0) and (jobAdManagedBean.pickMessageFirstTab != null)}">
			<h:panelGrid columns="1">
				<h:outputText value="#{jobAdManagedBean.pickMessageFirstTab}"
					styleClass="ui-message-info" />
			</h:panelGrid>
		</p:outputPanel>
		<p:outputPanel ajaxRendered="true"
				rendered="#{(jobAdManagedBean.customPick) and (jobAdManagedBean.tableTabNumber == 1) and (empty jobAdManagedBean.jobAds)}">
			<h:panelGrid columns="1">
				<h:outputText value="#{jobAdManagedBean.pickMessageSecondTabSimilarNotExistFirstSentence} #{jobAdManagedBean.year} #{jobAdManagedBean.name}"
					styleClass="ui-message-info" />
				<h:outputText value="#{jobAdManagedBean.pickMessageSecondTabSimilarNotExistSecondSentence}"
					styleClass="ui-message-info" />
			</h:panelGrid>
		</p:outputPanel>
		<p:outputPanel ajaxRendered="true"
				rendered="#{(jobAdManagedBean.customPick) and (jobAdManagedBean.tableTabNumber == 1) and (not empty jobAdManagedBean.jobAds)}">
			<h:panelGrid columns="1">
				<h:outputText value="#{jobAdManagedBean.pickMessageSecondTabSimilarExistFirstSentence} #{jobAdManagedBean.year} #{jobAdManagedBean.name}"
					styleClass="ui-message-info" />
				<h:outputText value="#{jobAdManagedBean.pickMessageSecondTabSimilarExistSecondSentence}"
					styleClass="ui-message-info" />
				<h:panelGroup>
					<h:outputText value="#{jobAdManagedBean.pickMessageSecondTabSimilarExistThirdSentence}"
						styleClass="ui-message-info" />
					<h:graphicImage library="img" name="pick.png" />
				</h:panelGroup>
				<h:outputText value="#{jobAdManagedBean.pickMessageSecondTabSimilarExistFourthSentence}"
					styleClass="ui-message-info" />
			</h:panelGrid>
		</p:outputPanel>
		<p:spacer
			height="10"
			width="1"
			/>
		<h:panelGrid columns="5" columnClasses="width20, width30, width10, width10, width30" width="100%"
			rendered="#{(jobAdManagedBean.tableTabNumber == 0) and (jobAdManagedBean.customPick)}">
			<!-- ....... Name .......           -->
			<p:outputPanel ajaxRendered="true">
				<mytags:outputLabel 
					value="#{messages['records.jobAd.editPanel.name']}*" 
					for="name" 
					errorStyleClass="errorMessage" />
			</p:outputPanel>
			<p:fragment>
				<p:autoComplete
		            id="name" 
		            value="#{jobAdManagedBean.name}"
		            required="true"
					mode="cachedAjax"
					autocompleteMethod="#{jobAdManagedBean.autocomplete}" 
		            var="_jobAdRow"
		            fetchValue="#{_jobAdRow.controlNumber}" 
		            minChars="3" 
		            onselectitem="if(this.value.indexOf('(BISIS)') != -1){activeElId = 'aInput'; pickControlNumber(this, #{p:resolveFirstComponentWithId('controlNumber', view).clientId});choose(#{p:resolveFirstComponentWithId('controlNumber', view).clientId}.value)}"
		            onkeyup="pickControlNumber(this, #{p:resolveFirstComponentWithId('controlNumber', view).clientId})"
		            onfocus="activeElId = this.id;"
		            >
		            <!--     ........  stringRepresentation   .......-->
					<p:column
						style="'background-color:#{org.richfaces.SKIN.tableBackgroundColor}';"
						styleClass="ui-datatable-wide-cell" >
						<h:outputText value="#{_jobAdRow.stringRepresentation}" />
					</p:column>
					<p:remoteCommand
						name="choose" 
						action="#{jobAdManagedBean.chooseJobAd}" 
						render="mainPanel, #{jobAdManagedBean.renderModalPanels}">
						<f:param
							name="param1" 
							assignTo="#{jobAdManagedBean.jobAdControlNumber}"/>
					</p:remoteCommand>
				</p:autoComplete>
		    </p:fragment>
			<h:inputHidden id="controlNumber"/>
			<h:outputText value="" />
			<p:outputPanel ajaxRendered="true">
				<p:message
					for="name" 
					errorClass="errorMessage"
					infoClass="infoMessage"
					warnClass="warnMessage"
					fatalClass="fatalMessage" />
			</p:outputPanel>
		</h:panelGrid>
		<h:panelGrid width="100%"
			rendered="#{(jobAdManagedBean.tableTabNumber == 1) or (not jobAdManagedBean.customPick)}">
			<ui:include src="../normativeRecords/jobAdTable.xhtml" />
		</h:panelGrid>
		<h:panelGrid columns="2">
			<p:commandButton
				rendered="#{(jobAdManagedBean.tableTabNumber == 1) and (jobAdManagedBean.customPick)}"
				action="#{jobAdManagedBean.previousTableTab}"
				value="#{messages['records.jobAd.pickPanel.btnPrevious']}"
				render="jobAdBrowseModalPanel"
				limitRender="true" 
				execute="@form" />
			<p:commandButton
				id="nextBtn"
				action="#{jobAdManagedBean.nextTableTab}"
				value="#{messages['records.jobAd.pickPanel.btnNext']}"
				render="jobAdBrowseModalPanel"
				rendered="#{(jobAdManagedBean.tableTabNumber == 0) and (jobAdManagedBean.customPick)}"
				limitRender="true" 
				execute="@form" />
			<p:commandButton
				rendered="#{(jobAdManagedBean.tableTabNumber == 1) and (jobAdManagedBean.customPick) and (userManagedBean.privileges[privilegesManagedBean.formJobAd][privilegesManagedBean.add])}"
				action="#{jobAdManagedBean.switchToAddMode}"
				value="#{messages['records.jobAd.pickPanel.btnNext']}"
				render="jobAdEditModalPanel" 
				limitRender="true"
				execute="@this" 
				immediate="true" />
		</h:panelGrid>
	</h:panelGrid>
</ui:composition>
