<ui:composition xmlns="http://www.w3.org/1999/xhtml"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:p="http://primefaces.org/ui"
     xmlns:mytags="http://dragan.tmd.uns.ac.rs/mytags">

	<h:panelGrid id="conferenceEditFormPanel">
		<p:inputText id="general" rendered="false" value="" />
		<p:outputPanel ajaxRendered="true">
			<p:message
				for="general"
				errorClass="errorMessage"
				infoClass="infoMessage"
				warnClass="warnMessage"
				fatalClass="fatalMessage"/>
		</p:outputPanel>
		<!-- .......Conference.......           -->
		<p:panel id="conferencePreview"
			header="#{messages['records.conference.editPanel.preview']}"
			rendered="#{conferenceManagedBean.editTabNumber == 2}">
			<p:outputPanel ajaxRendered="true">
				<h:panelGrid columns="1">
					<h:outputText
						value="#{conferenceManagedBean.selectedConference.stringRepresentation}"
						styleClass="preview" />
				</h:panelGrid>
			</p:outputPanel>
		</p:panel>
		<p:panel
			id="scrollableBody"
			rendered="#{conferenceManagedBean.editTabNumber lt 2}"
			styleClass="scrollableBody">
			<p:panel id="conferenceFullPreview"
				header="#{messages['records.conference.editPanel.preview']}"
				rendered="#{(conferenceManagedBean.editMode == modesManagedBean.import) and (conferenceManagedBean.editTabNumber == 1)}">
				<p:outputPanel ajaxRendered="true">
					<h:panelGrid columns="1">
						<h:outputText
							value="#{conferenceManagedBean.selectedConference.HTMLRepresentation}"
							styleClass="preview" 
							escape="false"/>
					</h:panelGrid>
				</p:outputPanel>
				<p:commandLink
					render="relatedRecordsEditModalPanel"
				    execute="@this" 
				    limitRender="true">
				    <h:graphicImage library="img" name="publications.png" />
				    <f:setPropertyActionListener target="#{relatedRecordsManagedBean.selectedRecord}"
				        value="#{conferenceManagedBean.selectedConference}" />
				    <p:tooltip followMouse="true" direction="topRight"
						showDelay="1000" styleClass="tooltip" mode="client">
						<span class="tooltipSpan"> 
							<h:panelGrid columns="2">
								<h:graphicImage library="img" name="publicationsToolTip.png" />
								<h:outputText
									value="#{messages['records.conference.tablePanel.btnPublications']}" />
							</h:panelGrid> 
						</span>
					</p:tooltip>
				</p:commandLink>
			</p:panel>
			<p:tabView
				switchType="#{(conferenceManagedBean.editMode == modesManagedBean.viewDetails)?'client':'ajax'}" 
				activeItem="#{conferenceManagedBean.activeEditTab}" >
				<p:tab
					name="tab0"
					header="#{messages['records.conference.editPanel.firstTab']}"
					rendered="#{conferenceManagedBean.editTabNumber == 0}">
					<h:panelGrid columns="5" columnClasses="width20, width30, width10, width10, width30" width="100%">
						<!--  ...... language ..... -->
						<p:outputPanel ajaxRendered="true">
							<mytags:outputLabel 
								value="#{messages['records.conference.editPanel.nameLanguage']}*" 
								for="language" 
								errorStyleClass="errorMessage" />
						</p:outputPanel>
						<p:selectOneMenu
							id="language"
							disabled="#{(conferenceManagedBean.editMode == modesManagedBean.viewDetails)}"
							value="#{conferenceManagedBean.selectedConference.name.language}" 
							required="true"	>
							<ui:include src="../languagesSelectItems.xhtml"/>
						</p:selectOneMenu>
						<h:outputText value="" />
						<h:outputText value="" />
						<p:outputPanel ajaxRendered="true">
							<p:message
								for="language" 
								errorClass="errorMessage"
								infoClass="infoMessage"
								warnClass="warnMessage"
								fatalClass="fatalMessage" />
						</p:outputPanel>
						<!-- ....... Name .......           -->
						<p:outputPanel ajaxRendered="true">
							<mytags:outputLabel 
								value="#{messages['records.conference.editPanel.name']}*" 
								for="name" 
								errorStyleClass="errorMessage" />
						</p:outputPanel>
						<p:inputTextarea
							id="name"
							readonly="#{(conferenceManagedBean.editMode == modesManagedBean.viewDetails)}" 
							value="#{conferenceManagedBean.selectedConference.name.content}"
							rows="3" 
							required="#{empty conferenceManagedBean.selectedConference.nameTranslations}"/>
						<p:commandButton
							action="#{conferenceManagedBean.nameTranslations}"
							value="#{messages['records.conference.editPanel.btnNameTranslations']}"
							update="multilingualContentEditModalPanel"
							execute="@this"/>
						<h:outputText value="" />
						<p:outputPanel ajaxRendered="true">
							<p:message
								for="name" 
								errorClass="errorMessage"
								infoClass="infoMessage"
								warnClass="warnMessage"
								fatalClass="fatalMessage" />
						</p:outputPanel>
						<!-- ....... Place .......           -->
						<p:outputPanel ajaxRendered="true">
							<mytags:outputLabel 
								value="#{messages['records.conference.editPanel.place']}" 
								for="place" 
								errorStyleClass="errorMessage" />
						</p:outputPanel>
						<p:inputText
							id="place"
							readonly="#{(conferenceManagedBean.editMode == modesManagedBean.viewDetails)}" 
							value="#{conferenceManagedBean.selectedConference.place}"
							maxlength="200" />
						<h:outputText value="" />
						<h:outputText value="" />
						<p:outputPanel ajaxRendered="true">
							<p:message
								for="place" 
								errorClass="errorMessage"
								infoClass="infoMessage"
								warnClass="warnMessage"
								fatalClass="fatalMessage" />
						</p:outputPanel>
						<!-- ....... State .......           -->
						<p:outputPanel ajaxRendered="true">
							<mytags:outputLabel 
								value="#{messages['records.conference.editPanel.state']}" 
								for="state" 
								errorStyleClass="errorMessage" />
						</p:outputPanel>
						<p:inputText
							id="state"
							readonly="#{(conferenceManagedBean.editMode == modesManagedBean.viewDetails)}" 
							value="#{conferenceManagedBean.selectedConference.state}"
							maxlength="200" />
						<h:outputText value="" />
						<h:outputText value="" />
						<p:outputPanel ajaxRendered="true">
							<p:message
								for="state" 
								errorClass="errorMessage"
								infoClass="infoMessage"
								warnClass="warnMessage"
								fatalClass="fatalMessage" />
						</p:outputPanel>
						<!-- ....... Year .......           -->
						<p:outputPanel ajaxRendered="true">
							<mytags:outputLabel 
								value="#{messages['records.conference.editPanel.year']}*" 
								for="year" 
								errorStyleClass="errorMessage" />
						</p:outputPanel>
						<p:inputText
							id="year"
							readonly="#{(conferenceManagedBean.editMode == modesManagedBean.viewDetails)}" 
							value="#{conferenceManagedBean.selectedConference.year}"
							required="true"/>
						<h:outputText value="" />
						<h:outputText value="" />
						<p:outputPanel ajaxRendered="true">
							<p:message
								for="year" 
								errorClass="errorMessage"
								infoClass="infoMessage"
								warnClass="warnMessage"
								fatalClass="fatalMessage" />
						</p:outputPanel>
						<!-- ....... Period .......           -->
						<p:outputPanel ajaxRendered="true">
							<mytags:outputLabel 
								value="#{messages['records.conference.editPanel.period']}" 
								for="period" 
								errorStyleClass="errorMessage" />
						</p:outputPanel>
						<p:inputText
							id="period"
							readonly="#{(conferenceManagedBean.editMode == modesManagedBean.viewDetails)}" 
							value="#{conferenceManagedBean.selectedConference.period}"
							maxlength="200" />
						<h:outputText value="" />
						<h:outputText value="" />
						<p:outputPanel ajaxRendered="true">
							<p:message
								for="period" 
								errorClass="errorMessage"
								infoClass="infoMessage"
								warnClass="warnMessage"
								fatalClass="fatalMessage" />
						</p:outputPanel>
						<!-- ....... Number .......           -->
						<p:outputPanel ajaxRendered="true">
							<mytags:outputLabel 
								value="#{messages['records.conference.editPanel.number']}" 
								for="number" 
								errorStyleClass="errorMessage" />
						</p:outputPanel>
						<p:inputText
							id="number"
							readonly="#{(conferenceManagedBean.editMode == modesManagedBean.viewDetails)}" 
							value="#{conferenceManagedBean.selectedConference.number}" />
						<h:outputText value="" />
						<h:outputText value="" />
						<p:outputPanel ajaxRendered="true">
							<p:message
								for="number" 
								errorClass="errorMessage"
								infoClass="infoMessage"
								warnClass="warnMessage"
								fatalClass="fatalMessage" />
						</p:outputPanel>
						<!-- ....... Description .......           -->
						<p:outputPanel ajaxRendered="true">
							<mytags:outputLabel 
								value="#{messages['records.conference.editPanel.description']}" 
								for="description" 
								errorStyleClass="errorMessage" />
						</p:outputPanel>
						<p:inputTextarea
							id="description"
							readonly="#{(conferenceManagedBean.editMode == modesManagedBean.viewDetails)}" 
							value="#{conferenceManagedBean.selectedConference.description.content}"
							rows="3"/>
						<p:commandButton
							action="#{conferenceManagedBean.descriptionTranslations}"
							value="#{messages['records.conference.editPanel.btnDescriptionTranslations']}"
							update="multilingualContentEditModalPanel"
							execute="@this"/>
						<h:outputText value="" />
						<p:outputPanel ajaxRendered="true">
							<p:message
								for="description" 
								errorClass="errorMessage"
								infoClass="infoMessage"
								warnClass="warnMessage"
								fatalClass="fatalMessage" />
						</p:outputPanel>
						<!-- ....... Keywords .......           -->
						<p:outputPanel ajaxRendered="true">
							<mytags:outputLabel 
								value="#{messages['records.conference.editPanel.keywords']}" 
								for="keywords" 
								errorStyleClass="errorMessage" />
						</p:outputPanel>
						<p:inputTextarea
							id="keywords"
							readonly="#{(conferenceManagedBean.editMode == modesManagedBean.viewDetails)}" 
							value="#{conferenceManagedBean.selectedConference.keywords.content}"
							rows="3"/>
						<p:commandButton
							action="#{conferenceManagedBean.keywordsTranslations}"
							value="#{messages['records.conference.editPanel.btnKeywordsTranslations']}"
							update="multilingualContentEditModalPanel"
							execute="@this"/>
						<h:outputText value="" />
						<p:outputPanel ajaxRendered="true">
							<p:message
								for="keywords" 
								errorClass="errorMessage"
								infoClass="infoMessage"
								warnClass="warnMessage"
								fatalClass="fatalMessage" />
						</p:outputPanel>
						<!-- ....... URI ....... -->
						<p:outputPanel ajaxRendered="true">
							<mytags:outputLabel 
								value="#{messages['records.conference.editPanel.uri']}" 
								for="uri" 
								errorStyleClass="errorMessage" />
						</p:outputPanel>
						<p:inputTextarea
							id="uri"
							readonly="#{(conferenceManagedBean.editMode == modesManagedBean.viewDetails)}"
							value="#{conferenceManagedBean.selectedConference.uri}"
							rows="3"/>
						<h:outputText value="" />
						<h:outputText value="" />
						<p:outputPanel ajaxRendered="true">
							<p:message
								for="uri" 
								errorClass="errorMessage"
								infoClass="infoMessage"
								warnClass="warnMessage"
								fatalClass="fatalMessage" />
						</p:outputPanel>
					</h:panelGrid>
				</p:tab>
				<p:tab
					name="tab1"
					header="#{messages['records.conference.editPanel.secondTab']}"
					rendered="#{(conferenceManagedBean.editTabNumber == 1) and ((conferenceManagedBean.editMode == modesManagedBean.add) or (conferenceManagedBean.editMode == modesManagedBean.import))}">
					<p:outputPanel ajaxRendered="true">
						<h:panelGrid columns="2">
							<h:graphicImage library="img" name="info.png" />
							<h:outputText value="#{conferenceManagedBean.pickSimilarMessage}"
								styleClass="ui-message-info" />
						</h:panelGrid>
					</p:outputPanel>
					<p:spacer
						height="10"
						width="1"
						/>
					<p:dataTable
						id="conferenceTable" 
						value="#{conferenceManagedBean.similarConferences}"
						var="conferenceRow" >
						<!--     ........  name   .......-->
						<p:column >
							<f:facet name="header">
								<h:outputText
									value="#{messages['records.conference.tablePanel.name']}" />
							</f:facet>
							<h:outputText value="#{conferenceRow.someName}" />
						</p:column>
						<!--     ........  place   .......-->
						<p:column >
							<f:facet name="header">
								<h:outputText
									value="#{messages['records.conference.tablePanel.place']}" />
							</f:facet>
							<h:outputText value="#{conferenceRow.place}" />
						</p:column>
						<!--     ........  year  .......-->
						<p:column >
							<f:facet name="header">
								<h:outputText
									value="#{messages['records.conference.tablePanel.year']}" />
							</f:facet>
							<h:outputText value="#{conferenceRow.year}" />
						</p:column>
						<!--     ........  number   .......-->
						<p:column >
							<f:facet name="header">
								<h:outputText
									value="#{messages['records.conference.tablePanel.number']}" />
							</f:facet>
							<h:outputText value="#{conferenceRow.number}" />
						</p:column>
						<!--     ........  chooseSimilar   .......-->
						<p:column>
							<f:facet name="header">
								<h:outputText
									value="#{messages['records.conference.tablePanel.chooseSimilar']}" />
							</f:facet>
							<p:commandLink
								action="#{conferenceManagedBean.chooseSimilar}"
								render="mainPanel, #{conferenceManagedBean.renderModalPanels}"
								rendered="#{(conferenceManagedBean.editMode != modesManagedBean.import)}"
								limitRender="true"
								immediate="true"
								execute="@this">
								<h:graphicImage library="img" name="pick.png" />
								<f:param name="controlNumber" value="#{conferenceRow.controlNumber}" />
								<p:tooltip followMouse="true" direction="topRight"
									showDelay="1000" styleClass="tooltip" mode="client">
									<span class="tooltipSpan"> 
										<h:panelGrid columns="2">
											<h:graphicImage library="img" name="pickToolTip.png" />
											<h:outputText
												value="#{messages['records.conference.tablePanel.btnPick']}" />
										</h:panelGrid> 
									</span>
								</p:tooltip>
							</p:commandLink>
							<p:commandLink
								action="#{conferenceManagedBean.examineData}"
								render="mainPanel, #{conferenceManagedBean.renderModalPanels}"
								rendered="#{(conferenceManagedBean.editMode == modesManagedBean.import) }"
								limitRender="true"
								immediate="true"
								execute="@this">
								<h:graphicImage library="img" name="pick.png" />
								<f:param name="controlNumber" value="#{conferenceRow.controlNumber}" />
								<p:tooltip followMouse="true" direction="topRight"
									showDelay="1000" styleClass="tooltip" mode="client">
									<span class="tooltipSpan"> 
										<h:panelGrid columns="2">
											<h:graphicImage library="img" name="pickToolTip.png" />
											<h:outputText
												value="#{messages['records.conference.tablePanel.btnExamine']}" />
										</h:panelGrid> 
									</span>
								</p:tooltip>
							</p:commandLink>
							<p:commandLink
								render="relatedRecordsEditModalPanel"
							    execute="@this" 
							    limitRender="true">
							    <h:graphicImage library="img" name="publications.png" />
							    <f:setPropertyActionListener target="#{relatedRecordsManagedBean.selectedRecord}"
							        value="#{conferenceRow}" />
								<p:tooltip followMouse="true" direction="topRight"
									showDelay="1000" styleClass="tooltip" mode="client">
									<span class="tooltipSpan"> 
										<h:panelGrid columns="2">
											<h:graphicImage library="img" name="publicationsToolTip.png" />
											<h:outputText
												value="#{messages['records.conference.tablePanel.btnPublications']}" />
										</h:panelGrid> 
									</span>
								</p:tooltip>
							</p:commandLink>
						</p:column>
					</p:dataTable>
				</p:tab>
				<p:tab
					name="tab2"
					header="#{messages['records.conference.editPanel.thirdTab']}"
					rendered="#{(conferenceManagedBean.editMode == modesManagedBean.viewDetails)}">
					<p:outputPanel ajaxRendered="true">
						<p:inputTextarea
							value="#{conferenceManagedBean.selectedConference.record.MARC21Record.printableString}"
							readonly="true" cols="60" styleClass="marc21TextArea" />
					</p:outputPanel>
				</p:tab>
			</p:tabView>
		</p:panel>
		<!--================= Update, Create, Cancel buttons ====================  -->
		<h:panelGrid>
		<p:commandButton
				rendered="#{((conferenceManagedBean.editMode == modesManagedBean.update) or ((conferenceManagedBean.editMode == modesManagedBean.import) and (not empty conferenceManagedBean.selectedConference.controlNumber))) and ((conferenceManagedBean.editTabNumber == 0) or (conferenceManagedBean.editTabNumber == 1))}"
				action="#{conferenceManagedBean.update}"
				value="#{messages['records.conference.editPanel.btnUpdate']}"
				update="conferenceEditModalPanel"
				limitRender="true" 
				execute="@form" />
			<p:commandButton
				rendered="#{((conferenceManagedBean.editMode == modesManagedBean.add) or ((conferenceManagedBean.editMode == modesManagedBean.import) and (empty conferenceManagedBean.selectedConference.controlNumber))) and ((conferenceManagedBean.editTabNumber == 0) or (conferenceManagedBean.editTabNumber == 1))}"
				action="#{conferenceManagedBean.add}"
				value="#{messages['records.conference.editPanel.btnCreate']}"
				render="conferenceEditModalPanel" 
				limitRender="true" 
				execute="@form"
				/>
			<p:commandButton
				rendered="#{(conferenceManagedBean.editMode == modesManagedBean.import) and (conferenceManagedBean.editTabNumber == 5)}"
				action="#{conferenceManagedBean.examineData}"
				value="#{messages['records.conference.editPanel.btnExamine']}"
				render="conferenceEditModalPanel" 
				limitRender="true" 
				execute="@this" />
			<p:commandButton
				rendered="#{(conferenceManagedBean.editTabNumber == 2)}" 
				action="#{conferenceManagedBean.finishWizard}"
				value="#{messages['records.conference.editPanel.btnAllRight']}"
				render="mainPanel, #{conferenceManagedBean.renderModalPanels}"
				limitRender="true"
				immediate="true" 
				execute="@this"/>
		</h:panelGrid>
	</h:panelGrid>
</ui:composition>