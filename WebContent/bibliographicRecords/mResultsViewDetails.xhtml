<ui:composition xmlns="http://www.w3.org/1999/xhtml"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:p="http://primefaces.org/ui"
     xmlns:mytags="http://dragan.tmd.uns.ac.rs/mytags"
     >
     <h:outputStylesheet>
        .wide-panel {
        	margin-left: 1% !important;
			margin-right: 1% !important;
			text-align: left !important; 
			width: 98% !important;
			overflow: auto !important;
		        	        	
        }      
     </h:outputStylesheet>       
    
     
	
    
    <!--=================APV Registered Researcher Short Info ====================  -->
	<h:panelGrid columns="2" id="apvRegisteredResearcherShortDetailsPanelGrid" columnClasses="width20, width80" style="align:left;font-size: 22px" >
		<h:outputText value="#{messages['records.apvRegisteredResearcher.viewDetails.person.commisionFreeText']}"/>
		<h:outputText value="#{apvRegisteredResearchersManagedBean.selectedAuthorOrgUnit.someName}"/>
		<h:outputText value="#{messages['records.apvRegisteredResearcher.viewDetails.person.usedRuleBook']}"/>
		<h:outputLink
			value="#{apvRegisteredResearchersManagedBean.pdfUrl}"
			target="_blank"
			rendered="#{not empty apvRegisteredResearchersManagedBean.pdfUrl}">
			<h:graphicImage library="img" name="download32.png" alt="none"/>
		</h:outputLink>
		<h:graphicImage library="img" name="download32.png"  alt="none" rendered="#{empty apvRegisteredResearchersManagedBean.pdfUrl}"/>

	</h:panelGrid>
	<h:panelGrid columns="1">
		<h:panelGrid columns="6" columnClasses="width10, width10,width10, width10, width20, width20" width="100%">
			<h:outputText value="#{messages['records.apvRegisteredResearcher.viewDetails.fromDate']}" style="align:left;font-size: 22px"/>
			<p:selectOneMenu value="#{apvRegisteredResearchersManagedBean.fromDate}">
				<f:selectItem itemLabel="#{messages['records.apvRegisteredResearcher.viewDetails.fromDateCh0']}" itemValue="#{searchManagedBean.searchQueryTypeString[0]}"/>
				<f:selectItems value="#{searchManagedBean.dateRange}"/>
			</p:selectOneMenu>
			<h:outputText value="#{messages['records.apvRegisteredResearcher.viewDetails.toDate']}" style="align:left;font-size: 22px"/>
			<p:selectOneMenu value="#{apvRegisteredResearchersManagedBean.toDate}">
				<f:selectItem itemLabel="#{messages['records.apvRegisteredResearcher.viewDetails.toDateCh0']}" itemValue="#{searchManagedBean.searchQueryTypeString[0]}"/>
				<f:selectItems value="#{searchManagedBean.dateRange}"/>
			</p:selectOneMenu>
			<p:commandButton
				action="#{apvRegisteredResearchersManagedBean.calculateAgain}"
				title="#{messages['records.apvRegisteredResearcher.viewDetails.btnCalculateAgain']}"
				icon="pi pi-filter"
				styleClass="rounded-button ui-button-flat"
				update="@form"
			/>
			<!-- <p:commandButton
				action="#{apvRegisteredResearchersManagedBean.prepareReportGeneration}"
				value="#{messages['records.apvRegisteredResearcher.viewDetails.btnPrepareReportGeneration']}"
				render="reportPublicationsEditModalPanel"
				execute="@this"
				limitRender="true"/> -->
		</h:panelGrid>
	</h:panelGrid>
	<br/>

	<p:dataTable
		value="#{apvRegisteredResearchersManagedBean.selectedAuthorKNR.resultsGroups}"
		var="list"
		styleClass="stable"
		tableStyle="width:auto">
		<p:column>
			<f:facet name="header">
				<h:outputText
					value="#{messages['records.apvRegisteredResearcher.viewDetails.productionTable.resultType']}"
					style="font-size: 14px"/>
			</f:facet>
			<h:outputText
					value="#{list.resultType.classId}"
					style="font-size: 14px" />
		</p:column>
		<p:column>
			<f:facet name="header">
				<h:outputText
						value="#{messages['records.apvRegisteredResearcher.viewDetails.productionTable.resultName']}"
						style="font-size: 14px"
				/>
			</f:facet>
			<p:commandButton id="resultgroup" value="#{list.resultType.someTerm}" type="button"/>
			<p:overlayPanel for="resultgroup">
				<p:dataList
						value="#{list.results}"
						var="item"
						type="unordered"
				>
					<div style="margin-bottom: 10px;">
						<h:outputText
								value="#{item.publication.harvardRepresentation}"
								rendred="true"
								escape="false"
								style="font-size: 14px" />
					</div>
				</p:dataList>
			</p:overlayPanel>
		</p:column>
		<p:column
				rendered="#{(userManagedBean.privileges[privilegesManagedBean.formReportSE][privilegesManagedBean.showInMainMenu]) or (userManagedBean.loggedIn and userManagedBean.loggedUser.author.controlNumber == researcherProfileManagedBean.selectedAuthor.controlNumber)}"
			>
			<f:facet name="header">
				<h:outputText
						value="#{messages['records.apvRegisteredResearcher.viewDetails.productionTable.count']}"
						style="font-size: 14px"
				/>
			</f:facet>
			<h:outputText value="#{list.results.size()}" />
			<f:facet name="footer">
				<h:outputText
						value="#{apvRegisteredResearchersManagedBean.selectedAuthorKNR.totalPapers}"
						style="font-size: 14px"/>
			</f:facet>
		</p:column>
		<p:column
				rendered="#{(userManagedBean.privileges[privilegesManagedBean.formReportSE][privilegesManagedBean.showInMainMenu]) or (userManagedBean.loggedIn and userManagedBean.loggedUser.author.controlNumber == researcherProfileManagedBean.selectedAuthor.controlNumber)}"
			>
			<f:facet name="header">
				<h:outputText
						value="#{messages['records.apvRegisteredResearcher.viewDetails.productionTable.points']}"
						style="font-size: 14px"
				/>
			</f:facet>
			<h:outputText
					value="#{list.quantitativeMeasure.doubleValue()*list.results.size()}"
			>
				<f:convertNumber maxFractionDigits="1" />
			</h:outputText>
			<f:facet name="footer">
				<h:outputText
						value="#{apvRegisteredResearchersManagedBean.selectedAuthorKNR.totalPoints}"
						style="font-size: 14px"
				/>
			</f:facet>
		</p:column>
	</p:dataTable>
</ui:composition>     