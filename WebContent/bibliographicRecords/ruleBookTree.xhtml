<ui:composition xmlns="http://www.w3.org/1999/xhtml"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:p="http://primefaces.org/ui"
     xmlns:mytags="http://dragan.tmd.uns.ac.rs/mytags">

	<p:panel
		id="scrollableBodyTree" 
		styleClass="scrollableBody">
		<!-- ===========================   treePanel  ============================= -->
		<p:spacer
			height="10"
			width="1"
			/>
		<h:panelGrid id="ruleBookTreePanel">
			<p:tree
					id = "ruleBookAndRuleBookImplementationsTree"
					value="#{ruleBookManagedBean.rootNodes}"
					var="ruleBookNode"
			>
				<p:treeNode
						type="RuleBookDTO"
						collapsedIcon="icon_ruleBook"
						expandedIcon="icon_ruleBook"
					>
					<h:outputText value="#{ruleBookNode}" />
					<p:commandLink
						action="#{ruleBookManagedBean.switchToViewDetailsMode}"
						render="ruleBookEditModalPanel" 
						limitRender="true"
						execute="@this" 
						immediate="true">
						<h:graphicImage library="img" name="details.png" />
						<f:param name="controlNumber" value="#{ruleBookNode.controlNumber}" />
						<ui:include src="../bibliographicRecords/ruleBookToolTip.xhtml"/>
					</p:commandLink>
					<p:commandLink
						rendered="#{userManagedBean.privileges[privilegesManagedBean.formRuleBook][privilegesManagedBean.update]}"
						action="#{ruleBookManagedBean.switchToUpdateMode}"
						render="ruleBookEditModalPanel" 
						limitRender="true"
						execute="@this" 
						immediate="true" >
						<h:graphicImage library="img" name="edit.png" />
						<f:param name="controlNumber" value="#{ruleBookNode.controlNumber}" />
						<ui:include src="../bibliographicRecords/ruleBookToolTip.xhtml"/>
					</p:commandLink>
					<p:commandLink
						rendered="#{userManagedBean.privileges[privilegesManagedBean.formRuleBook][privilegesManagedBean.delete]}"
						action="#{ruleBookManagedBean.delete}"
						render="ruleBookBrowseModalPanel"
						limitRender="true" 
						execute="@this" 
						immediate="true"
						onclick="if(!confirmDecision()) return false" >
						<h:graphicImage library="img" name="delete.png" />
						<f:param name="controlNumber" value="#{ruleBookNode.controlNumber}" />
						<ui:include src="../bibliographicRecords/ruleBookToolTip.xhtml"/>
					</p:commandLink>
					<p:commandLink
						rendered="#{(ruleBookManagedBean.tableMode == modesManagedBean.pick)}" 
						action="#{ruleBookManagedBean.chooseRuleBook}"
						render="mainPanel, #{ruleBookManagedBean.renderModalPanels}"
						immediate="true" 
						execute="@this" > 
						<h:graphicImage library="img" name="pick.png" />
						<f:param name="controlNumber" value="#{ruleBookNode.controlNumber}" />
						<ui:include src="../bibliographicRecords/ruleBookToolTip.xhtml"/>
					</p:commandLink>
					<p:commandLink
						action="#{ruleBookManagedBean.switchRuleBookImplementationToAddMode}"
						rendered="#{(userManagedBean.privileges[privilegesManagedBean.formRuleBookImplementation][privilegesManagedBean.add])}" 
						render="ruleBookImplementationEditModalPanel" 
						limitRender="true"
						execute="@this" 
						immediate="true">
						<h:graphicImage library="img" name="create24.png" />
						<f:param name="controlNumber" value="#{ruleBookNode.controlNumber}" />
						<ui:include src="../bibliographicRecords/ruleBookImplementationToolTip.xhtml"/>
					</p:commandLink>
				</p:treeNode>
				<p:treeNode
						type="RuleBookImplementationDTO"
						collapsedIcon="icon_ruleBookImplementation"
						expandedIcon="icon_ruleBookImplementation"
					>
					<h:outputText value="#{ruleBookNode}" />
					<p:commandLink
						action="#{ruleBookImplementationManagedBean.switchToViewDetailsMode}"
						render="ruleBookImplementationEditModalPanel" 
						limitRender="true"
						execute="@this" 
						immediate="true">
						<h:graphicImage library="img" name="details.png" />
						<f:param name="controlNumber" value="#{ruleBookNode.controlNumber}" />
						<ui:include src="../bibliographicRecords/ruleBookImplementationToolTip.xhtml"/>
					</p:commandLink>
					<p:commandLink
						rendered="#{userManagedBean.privileges[privilegesManagedBean.formRuleBookImplementation][privilegesManagedBean.update]}"
						action="#{ruleBookImplementationManagedBean.switchToUpdateMode}"
						render="ruleBookImplementationEditModalPanel" 
						limitRender="true"
						execute="@this" 
						immediate="true" >
						<h:graphicImage library="img" name="edit.png" />
						<f:param name="controlNumber" value="#{ruleBookNode.controlNumber}" />
						<ui:include src="../bibliographicRecords/ruleBookImplementationToolTip.xhtml"/>
					</p:commandLink>
					<p:commandLink
						rendered="#{userManagedBean.privileges[privilegesManagedBean.formRuleBookImplementation][privilegesManagedBean.delete]}"
						action="#{ruleBookImplementationManagedBean.delete}"
						render="ruleBookBrowseModalPanel"
						limitRender="true" 
						execute="@this" 
						immediate="true"
						onclick="if(!confirmDecision()) return false" >
						<h:graphicImage library="img" name="delete.png" />
						<f:param name="controlNumber" value="#{ruleBookNode.controlNumber}" />
						<ui:include src="../bibliographicRecords/ruleBookImplementationToolTip.xhtml"/>
					</p:commandLink>
					<p:commandLink
						rendered="#{(ruleBookImplementationManagedBean.tableMode == modesManagedBean.pick)}" 
						action="#{ruleBookImplementationManagedBean.chooseRuleBookImplementation}"
						render="mainPanel, #{ruleBookImplementationManagedBean.renderModalPanels}"
						immediate="true" 
						execute="@this" > 
						<h:graphicImage library="img" name="pick.png" />
						<f:param name="controlNumber" value="#{ruleBookNode.controlNumber}" />
						<ui:include src="../bibliographicRecords/ruleBookImplementationToolTip.xhtml"/>
					</p:commandLink>
					<p:commandLink
						action="#{ruleBookImplementationManagedBean.switchToAddMode}"
						rendered="#{(userManagedBean.privileges[privilegesManagedBean.formRuleBookImplementation][privilegesManagedBean.add])}" 
						render="ruleBookImplementationEditModalPanel" 
						limitRender="true"
						execute="@this" 
						immediate="true">
						<h:graphicImage library="img" name="create24.png" />
						<f:param name="controlNumber" value="#{ruleBookNode.controlNumber}" />
						<ui:include src="../bibliographicRecords/ruleBookImplementationToolTip.xhtml"/>
					</p:commandLink>
				</p:treeNode>
	        </p:tree>
			<h:panelGrid columns="1">
				<p:commandLink
					action="#{ruleBookManagedBean.switchToAddMode}"
					rendered="#{(userManagedBean.privileges[privilegesManagedBean.formRuleBook][privilegesManagedBean.add])}" 
					render="ruleBookEditModalPanel" 
					limitRender="true"
					execute="@this" 
					immediate="true">
					<h:graphicImage library="img" name="create.png" />
					<ui:include src="../bibliographicRecords/ruleBookToolTip.xhtml"/>
				</p:commandLink>
			</h:panelGrid>
		</h:panelGrid>
	</p:panel>
</ui:composition>