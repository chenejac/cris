<ui:composition xmlns="http://www.w3.org/1999/xhtml"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:p="http://primefaces.org/ui"
     xmlns:mytags="http://dragan.tmd.uns.ac.rs/mytags">

	<p:panel id="publicationPreview"
		header="#{messages['records.studyFinalDocument.publications.preview']}">
		<p:inputText id="general" rendered="false" value="" />
		<p:outputPanel ajaxRendered="true">
			<p:message
				for="general"
				errorClass="errorMessage"
				infoClass="infoMessage"
				warnClass="warnMessage"
				fatalClass="fatalMessage"/>
		</p:outputPanel>
		<p:panel
			id="scrollableBody"
			styleClass="scrollableBody"
			>
		<p:outputPanel ajaxRendered="true">
			<h:panelGrid columns="1">
				<h:outputText
					value="#{studyFinalDocumentManagedBean.selectedStudyFinalDocument.HTMLRepresentation}"
					styleClass="preview" 
					escape="false"/>
			</h:panelGrid>
		</p:outputPanel>
		<p:outputPanel ajaxRendered="true">
			<h:panelGrid columns="1">
				<h:outputText
					value="#{studyFinalDocumentManagedBean.selectedStudyFinalDocument.relatedPublicationsHTMLRepresentation}"
					styleClass="preview" 
					escape="false"/>
			</h:panelGrid>
		</p:outputPanel>
		
			<h:panelGrid 
				rendered="#{not empty studyFinalDocumentManagedBean.publications}"
				>
				<p:dataTable
					id="publicationTable"
					value="#{studyFinalDocumentManagedBean.publications}"
					var="publicationRow" 
					rows="10"
					paginator="true" paginatorPosition="bottom"
					paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
					currentPageReportTemplate="#{userManagedBean.currentPageReportTemplate}"
					rowsPerPageTemplate="#{userManagedBean.rowsPerPageTemplate}"
					>
					<p:column>
						<f:facet name="header">
							<h:outputText
								value="#{messages['records.studyFinalDocument.publications.records']}" />
						</f:facet>
						<h:outputText value="#{publicationRow.publication.stringRepresentation}" />
					</p:column>
					<p:column
						rendered="#{(userManagedBean.privileges[privilegesManagedBean.formStudyFinalDocument][privilegesManagedBean.update])}">
						<f:facet name="header">
							<h:outputText
								value="#{messages['records.studyFinalDocument.publications.actions']}" />
						</f:facet>
						<p:selectBooleanCheckbox value="#{publicationRow.selected}" />
					</p:column>
				</p:dataTable>
			</h:panelGrid>
			<h:panelGrid 
				rendered="#{empty studyFinalDocumentManagedBean.publications}">
				<h:outputText
					value="#{messages['records.studyFinalDocument.publications.norecords']}"
					styleClass="ui-message-info" />
			</h:panelGrid>
		</p:panel>
	</p:panel>
	<!--================= Update, Create, Cancel buttons ====================  -->
	<h:panelGrid 
		columns="3"
		rendered="#{(userManagedBean.privileges[privilegesManagedBean.formStudyFinalDocument][privilegesManagedBean.update])}" >
		<p:commandButton
			action="#{studyFinalDocumentManagedBean.updateSelectedPublications}"
			value="#{messages['records.studyFinalDocument.editPanel.btnUpdate']}"
			render="publicationPreview" 
			limitRender="true" 
			execute="@form" />
		<p:commandButton
			action="#{studyFinalDocumentManagedBean.selectAllPublications}"
			value="#{messages['records.studyFinalDocument.editPanel.btnSelectAll']}"
			render="publicationPreview" 
			limitRender="true" 
			execute="this" />
		<p:commandButton
			action="#{studyFinalDocumentManagedBean.deselectAllPublications}"
			value="#{messages['records.studyFinalDocument.editPanel.btnDeselectAll']}"
			render="publicationPreview" 
			limitRender="true" 
			execute="this" />
	</h:panelGrid>
</ui:composition>