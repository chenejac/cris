<ui:composition xmlns="http://www.w3.org/1999/xhtml"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:p="http://primefaces.org/ui"
     xmlns:mytags="http://dragan.tmd.uns.ac.rs/mytags">

	<h:panelGrid id="paperProceedingsTableFormPanel" >
		<p:inputText id="general" rendered="false" value="" />
		<p:outputPanel ajaxRendered="true">
			<p:message
				for="general"
				errorClass="errorMessage"
				infoClass="infoMessage"
				warnClass="warnMessage"
				fatalClass="fatalMessage"/>
		</p:outputPanel>
		<!-- .......Conference .......           -->
		<p:spacer
			height="10"
			width="1"
			/>
		<h:panelGrid 
			id="conference"
			columns="2" >
			<h:panelGroup
				rendered="#{(paperProceedingsManagedBean.conference != null)}"  >
				<h2>
					<h:outputText
						value="#{messages['records.paperProceedings.tablePanel.conference']}: " />
					<h:outputText 
						value="#{paperProceedingsManagedBean.conference.stringRepresentation}" />
				</h2>
			</h:panelGroup>
			<h:outputText 
				value="" 
				rendered="#{(paperProceedingsManagedBean.conference != null)}" />
			<p:commandButton
				action="#{paperProceedingsManagedBean.pickConference}"
				render="conferenceBrowseModalPanel"
				value="#{messages['records.paperProceedings.tablePanel.btnPickOtherConference']}"
				limitRender="true"  
				rendered="#{(paperProceedingsManagedBean.conference != null)}" 
				execute="@this" />
			<h:outputText 
				value="" 
				rendered="#{(paperProceedingsManagedBean.conference != null)}" />
			<p:commandButton
				action="#{paperProceedingsManagedBean.pickConference}"
				render="conferenceBrowseModalPanel"
				value="#{messages['records.paperProceedings.tablePanel.btnPickConference']}"
				limitRender="true" 
				rendered="#{(paperProceedingsManagedBean.conference == null)}" 
				execute="@this" />
			<h:panelGroup
				rendered="#{(paperProceedingsManagedBean.conference == null)}" >
				<h2>
					<h:outputText
						value="#{messages['records.paperProceedings.tablePanel.pleaseConference']}" />
				</h2>
			</h:panelGroup>
		</h:panelGrid>
		<!-- .......Proceedings.......           -->
		<h:panelGrid 
			id="proceedings"
			rendered="#{(paperProceedingsManagedBean.conference != null)}"
			columns="2" >
			<h:panelGroup 
				rendered="#{(paperProceedingsManagedBean.conferenceProceedings != null)}" >
				<h2>
					<h:outputText
						value="#{messages['records.paperProceedings.tablePanel.proceedings']}: "  />
					<p:selectOneMenu
						value="#{paperProceedingsManagedBean.proceedings}"
						style="width:100%"
						converter="proceedingsSelectConverter"
						>
						<f:selectItems
							value="#{paperProceedingsManagedBean.allProceedingsSelectItems}" />
						<p:ajax
			    			event="change" 
			    			render="@form" 
			    			limitRender="true" 
			    			execute="@form" 
			    			/>
					</p:selectOneMenu>
				</h2>
			</h:panelGroup>
			<p:commandButton
				action="#{paperProceedingsManagedBean.addProceedings}"
				render="proceedingsEditModalPanel"
				value="#{messages['records.paperProceedings.tablePanel.btnAddOtherProceedings']}"
				limitRender="true" 
				rendered="#{(paperProceedingsManagedBean.conferenceProceedings != null)}" />
			<p:commandButton
				action="#{paperProceedingsManagedBean.addProceedings}"
				render="proceedingsEditModalPanel"
				value="#{messages['records.paperProceedings.tablePanel.btnAddProceedings']}"
				limitRender="true" 
				rendered="#{(paperProceedingsManagedBean.conferenceProceedings == null)}" 
				execute="@this" />
			<h:panelGroup
				rendered="#{(paperProceedingsManagedBean.conferenceProceedings == null)}"  >
				<h2>
					<h:outputText
						value="#{messages['records.paperProceedings.tablePanel.pleaseProceedings']}" />
				</h2>
			</h:panelGroup>
		</h:panelGrid>
		<h:panelGrid
			rendered="#{(empty userManagedBean.loggedUser.author.controlNumber)||(paperProceedingsManagedBean.proceedings != null)}">
			<!-- ===========================   searchPanel  ============================= -->
			<p:spacer
				height="10"
				width="1"
				rendered="#{(paperProceedingsManagedBean.proceedings==null)}"
				/>
			<h:panelGrid 
				id="paperProceedingsSearchPanel"
				rendered="#{(paperProceedingsManagedBean.proceedings==null)}" 
				columns="6">
				<h:panelGroup>
					<h2>
						<p:outputPanel ajaxRendered="true">
							<mytags:outputLabel 
								value="#{messages['records.paperProceedings.searchPanel.header']}: " 
								for="whereStr" 
								errorStyleClass="errorMessage"
								/>
						</p:outputPanel>
					</h2>
				</h:panelGroup>
				<p:inputText
					id="whereStr"
					onkeydown="keyDownHandler(event, 'paperProceedingsTableForm:btnFind')"
					value="#{paperProceedingsManagedBean.whereStr}" 
					styleClass="searchBox" />
				<p:commandButton
					id="btnFind"
					value="#{messages['records.paperProceedings.searchPanel.btnFind']}"
					render="paperProceedingsTablePanel" 
					limitRender="true" 
					execute="@form" />
				<p:commandButton
					id="btnShowAll"
					action="#{paperProceedingsManagedBean.removeFilter}"
					value="#{messages['records.paperProceedings.searchPanel.btnShowAll']}"
					render="paperProceedingsTablePanel, paperProceedingsSearchPanel"
					execute="@this" 
					limitRender="true" />
				<p:commandButton
					id="btnShowM99PMF"
					action="#{paperProceedingsManagedBean.populateM99PMF}"
					value="#{messages['records.paperProceedings.searchPanel.btnShowM99PMF']}"
					render="paperProceedingsTablePanel, paperProceedingsSearchPanel"
					rendered="#{(userManagedBean.privileges[privilegesManagedBean.formInstitution][privilegesManagedBean.showInMainMenu])}" 
					execute="@this" 
					limitRender="true" />
				<p:commandButton
					id="btnShowM99TF"
					action="#{paperProceedingsManagedBean.populateM99TF}"
					value="#{messages['records.paperProceedings.searchPanel.btnShowM99TF']}"
					render="paperProceedingsTablePanel, paperProceedingsSearchPanel"
					rendered="#{(userManagedBean.privileges[privilegesManagedBean.formInstitution][privilegesManagedBean.showInMainMenu])}" 
					execute="@this" 
					limitRender="true" />
			</h:panelGrid>
			<!-- ===========================   tablePanel  ============================= -->
			<p:spacer
				height="10"
				width="1"
				/>
			<h:panelGrid id="paperProceedingsTablePanel">
			<h:panelGrid 
				rendered="#{(not empty paperProceedingsManagedBean.whereStr)||(paperProceedingsManagedBean.proceedings != null)}">
				<p:dataTable
					id="paperProceedingsTable"
					value="#{paperProceedingsManagedBean.paperProceedings}"
					var="paperProceedingsRow" 
					rows="10"
					paginator="true" paginatorPosition="bottom"
					paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
					currentPageReportTemplate="#{userManagedBean.currentPageReportTemplate}"
					rowsPerPageTemplate="#{userManagedBean.rowsPerPageTemplate}"
					>
					<!--     ........  reference   .......-->
					<p:column
						style="#{paperProceedingsManagedBean.selectedPaperProceedings.controlNumber == paperProceedingsRow.controlNumber?'background-color:#A1A1A1;':'background-color:#{org.richfaces.SKIN.tableBackgroundColor}'};">
						<f:facet name="header">
							<p:commandLink
								action="#{paperProceedingsManagedBean.sort}"
								render="paperProceedingsTable"
								limitRender="true" 
								execute="@this" 
								immediate="true">
								<h:outputText
									value="#{messages['records.paperProceedings.tablePanel.reference']}" />
								<h:graphicImage 
									library="img" name="up.gif"
									rendered="#{(paperProceedingsManagedBean.orderBy=='stringRepresentation') and (paperProceedingsManagedBean.direction=='asc')}" />
								<h:graphicImage 
									library="img" name="down.gif"
									rendered="#{(paperProceedingsManagedBean.orderBy=='stringRepresentation') and (paperProceedingsManagedBean.direction=='desc')}" />
								<f:param name="orderBy" value="stringRepresentation" />
							</p:commandLink>
						</f:facet>
						<h:outputText value="#{paperProceedingsRow.stringRepresentation}" />
					</p:column>
					<!--     ........  paperType   .......-->
					<p:column
						style="#{paperProceedingsManagedBean.selectedPaperProceedings.controlNumber == paperProceedingsRow.controlNumber?'background-color:#A1A1A1;':'background-color:#{org.richfaces.SKIN.tableBackgroundColor}'};">
						<f:facet name="header">
							<p:commandLink
								action="#{paperProceedingsManagedBean.sort}"
								render="paperProceedingsTableForm"
								limitRender="true" 
								execute="@this" 
								immediate="true">
								<h:outputText
									value="#{messages['records.paperProceedings.tablePanel.paperType']}" />
								<h:graphicImage library="img" name="up.gif"
									rendered="#{(paperProceedingsManagedBean.orderBy=='localizedPaperType') and (paperProceedingsManagedBean.direction=='asc')}" />
								<h:graphicImage library="img" name="down.gif"
									rendered="#{(paperProceedingsManagedBean.orderBy=='localizedPaperType') and (paperProceedingsManagedBean.direction=='desc')}" />
								<f:param name="orderBy" value="localizedPaperType" />
							</p:commandLink>
						</f:facet>
						<h:outputText value="#{paperProceedingsRow.localizedPaperType}" />
					</p:column>
					<!--     ........  actions   .......-->
					<p:column
						style="#{paperProceedingsManagedBean.selectedPaperProceedings.controlNumber == paperProceedingsRow.controlNumber?'background-color:#A1A1A1;':'background-color:#{org.richfaces.SKIN.tableBackgroundColor}'};">
						<f:facet name="header">
							<h:outputText
								value="#{messages['records.paperProceedings.tablePanel.actions']}" />
						</f:facet>
						<p:commandLink
							action="#{paperProceedingsManagedBean.switchToViewDetailsMode}"
							render="paperProceedingsEditModalPanel" 
							limitRender="true" 
							execute="@this"
							immediate="true">
							<h:graphicImage library="img" name="details.png" />
							<f:param name="controlNumber"
								value="#{paperProceedingsRow.controlNumber}" />
							<ui:include src="../bibliographicRecords/paperProceedingsToolTip.xhtml" />
						</p:commandLink>
						<p:commandLink
							rendered="#{userManagedBean.privileges[privilegesManagedBean.formPaperProceedings][privilegesManagedBean.update]}"
							action="#{paperProceedingsManagedBean.switchToSimpleUpdateMode}"
							render="paperProceedingsSimpleEditModalPanel"
							limitRender="true" 
							execute="@this" 
							immediate="true">
							<h:graphicImage library="img" name="edit.png" />
							<f:param name="controlNumber"
								value="#{paperProceedingsRow.controlNumber}" />
							<ui:include src="../bibliographicRecords/paperProceedingsToolTip.xhtml" />
						</p:commandLink>
						<p:commandLink
							rendered="#{userManagedBean.privileges[privilegesManagedBean.formPaperProceedings][privilegesManagedBean.delete]}"
							action="#{paperProceedingsManagedBean.delete}"
							onclick="if(!confirmDecision()) return false"
							render="paperProceedingsTablePanel"
							limitRender="true" 
							execute="@this" 
							immediate="true">
							<h:graphicImage library="img" name="delete.png" />
							<f:param name="controlNumber"
								value="#{paperProceedingsRow.controlNumber}" />
							<ui:include src="../bibliographicRecords/paperProceedingsToolTip.xhtml" />
						</p:commandLink>
					</p:column>
				</p:dataTable>
				<h:panelGrid columns="1">
					<h:panelGroup 
						rendered="#{userManagedBean.privileges[privilegesManagedBean.formPaperProceedings][privilegesManagedBean.add]}">
						<h3>
							<h:outputText
									value="#{messages['records.paperProceedings.tablePanel.btnCreate']}: " />
							<p:commandLink
								action="#{paperProceedingsManagedBean.switchToSimpleAddMode}"
								render="paperProceedingsSimpleEditModalPanel"
								limitRender="true" 
								execute="@this" 
								immediate="true" >
								<h:graphicImage library="img" name="create.png" />
								<ui:include src="../bibliographicRecords/paperProceedingsToolTip.xhtml"/>
							</p:commandLink>
						</h3>
					</h:panelGroup>
				</h:panelGrid>
			</h:panelGrid>
			</h:panelGrid>
		</h:panelGrid>
	</h:panelGrid>
</ui:composition>
